---

title: Data Loading


keywords: fastai
sidebar: home_sidebar

summary: "Module to load the roster table."
description: "Module to load the roster table."
nb_path: "01_main.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_main.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">roster2ical.roster</span> <span class="kn">import</span> <span class="n">Shift</span><span class="p">,</span> <span class="n">ShiftProperties</span><span class="p">,</span> <span class="n">Roster</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>
<span class="c1"># roster_path = data_path / &quot;202201_example_roster.xlsx&quot;</span>
<span class="n">roster_path</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;private&quot;</span> <span class="o">/</span> <span class="s2">&quot;202203_ZIB_Mar.xlsx&quot;</span>

<span class="n">day_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;MO|DI|MI|DO|FR|SA|SO&quot;</span><span class="p">)</span>
<span class="n">date_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">daycol</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">day_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">read_roster</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">daycol</span><span class="p">(</span><span class="n">col</span><span class="p">)]]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
<span class="n">full_roster</span> <span class="o">=</span> <span class="n">read_roster</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">roster_path</span><span class="p">)</span>
<span class="n">full_roster</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DI 01</th>
      <th>MI 02</th>
      <th>DO 03</th>
      <th>FR 04</th>
      <th>SA 05</th>
      <th>SO 06</th>
      <th>MO 07</th>
      <th>DI 08</th>
      <th>MI 09</th>
      <th>DO 10</th>
      <th>...</th>
      <th>MI 23</th>
      <th>DO 24</th>
      <th>FR 25</th>
      <th>SA 26</th>
      <th>SO 27</th>
      <th>MO 28</th>
      <th>DI 29</th>
      <th>MI 30</th>
      <th>DO 31</th>
      <th>FR 01</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Schneider, Niklas</th>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>...</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>RTH</td>
      <td>(/)</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
    </tr>
    <tr>
      <th>Müller, Georg</th>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>S1</td>
      <td>(/)</td>
      <td>Akad</td>
      <td>N1</td>
      <td>...</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>S1</td>
    </tr>
    <tr>
      <th>Hartmann, Volker</th>
      <td>F1</td>
      <td>S1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>...</td>
      <td>S1</td>
      <td>(/)</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Rusche, Katharina</th>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>...</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>N1</td>
    </tr>
    <tr>
      <th>Westrick, Oliver</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>...</td>
      <td>3g</td>
      <td>3g</td>
      <td>3g</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>S1</td>
      <td>F4</td>
    </tr>
    <tr>
      <th>Schott, Johannes</th>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Ehlert, Nina</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>...</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Weiß, Theresa</th>
      <td>S1</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
    </tr>
    <tr>
      <th>Kurktschiev, Peter</th>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>N1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Stancu, Alice</th>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>FB</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>...</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Labbene, Az(/)</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>...</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
    </tr>
    <tr>
      <th>Koller, Michael</th>
      <td>N1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>...</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>?</td>
    </tr>
    <tr>
      <th>Schlieper, Yasmin</th>
      <td>U</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>...</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Sentic, Ana-Marija</th>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>...</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>U</td>
      <td>F1</td>
      <td>F1</td>
      <td>S1</td>
      <td>N1</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 32 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">roster_df</span> <span class="o">=</span> <span class="n">full_roster</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">roster_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DI 01</th>
      <th>MI 02</th>
      <th>DO 03</th>
      <th>FR 04</th>
      <th>SA 05</th>
      <th>SO 06</th>
      <th>MO 07</th>
      <th>DI 08</th>
      <th>MI 09</th>
      <th>DO 10</th>
      <th>...</th>
      <th>DI 22</th>
      <th>MI 23</th>
      <th>DO 24</th>
      <th>FR 25</th>
      <th>SA 26</th>
      <th>SO 27</th>
      <th>MO 28</th>
      <th>DI 29</th>
      <th>MI 30</th>
      <th>DO 31</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Schneider, Niklas</th>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>...</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>RTH</td>
      <td>(/)</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
      <td>F0</td>
    </tr>
    <tr>
      <th>Müller, Georg</th>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>S1</td>
      <td>(/)</td>
      <td>Akad</td>
      <td>N1</td>
      <td>...</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Hartmann, Volker</th>
      <td>F1</td>
      <td>S1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>...</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
    </tr>
    <tr>
      <th>Rusche, Katharina</th>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>...</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Westrick, Oliver</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>...</td>
      <td>3g</td>
      <td>3g</td>
      <td>3g</td>
      <td>3g</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>S1</td>
    </tr>
    <tr>
      <th>Schott, Johannes</th>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Ehlert, Nina</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>...</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
    </tr>
    <tr>
      <th>Weiß, Theresa</th>
      <td>S1</td>
      <td>(/)</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
    </tr>
    <tr>
      <th>Kurktschiev, Peter</th>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>FB</td>
      <td>FB</td>
      <td>FB</td>
      <td>N1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>...</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Stancu, Alice</th>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>FB</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>...</td>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
    </tr>
    <tr>
      <th>Labbene, Az(/)</th>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>...</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F2</td>
      <td>F2</td>
      <td>S1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
    </tr>
    <tr>
      <th>Koller, Michael</th>
      <td>N1</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>...</td>
      <td>(/)</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
    </tr>
    <tr>
      <th>Schlieper, Yasmin</th>
      <td>U</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>U</td>
      <td>...</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>F1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
    </tr>
    <tr>
      <th>Sentic, Ana-Marija</th>
      <td>F1</td>
      <td>S1</td>
      <td>S1</td>
      <td>N1</td>
      <td>N2</td>
      <td>N2</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>F1</td>
      <td>F1</td>
      <td>...</td>
      <td>S1</td>
      <td>N1</td>
      <td>N1</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>(/)</td>
      <td>U</td>
      <td>F1</td>
      <td>F1</td>
      <td>S1</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 31 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abbr2shiftproperties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;(/)&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;2M&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;3g&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;RTH&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;NEF&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;NAW 24&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;V&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;F0&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Früh0&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;F1&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Früh1&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;F2&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Früh2&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;FB&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Fortbildung&quot;</span><span class="p">,</span>
        <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="s2">&quot;N1&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Nacht1&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">22</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;N2&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Nacht2&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;S1&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spät1&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Urlaub&quot;</span><span class="p">,</span> <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s2">&quot;ZA&quot;</span><span class="p">:</span> <span class="n">ShiftProperties</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Zeitausgleich&quot;</span><span class="p">,</span>
        <span class="n">starting_hour</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">roster_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">mapper</span><span class="o">=</span><span class="n">abbr2shiftproperties</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/indexes/base.py:3080</span>, in <span class="ansi-cyan-fg">Index.get_loc</span><span class="ansi-blue-fg">(self, key, method, tolerance)</span>
<span class="ansi-green-intense-fg ansi-bold">   3079</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 3080</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_engine</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">get_loc</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">casted_key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3081</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> err:

File <span class="ansi-green-fg">pandas/_libs/index.pyx:70</span>, in <span class="ansi-cyan-fg">pandas._libs.index.IndexEngine.get_loc</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">pandas/_libs/index.pyx:101</span>, in <span class="ansi-cyan-fg">pandas._libs.index.IndexEngine.get_loc</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">pandas/_libs/hashtable_class_helper.pxi:4554</span>, in <span class="ansi-cyan-fg">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">pandas/_libs/hashtable_class_helper.pxi:4562</span>, in <span class="ansi-cyan-fg">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">KeyError</span>: &#39;&#39;

The above exception was the direct cause of the following exception:

<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Input <span class="ansi-green-fg">In [21]</span>, in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> name <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-fg">----&gt; 2</span> r <span style="color: rgb(98,98,98)">=</span> Roster<span style="color: rgb(98,98,98)">.</span>from_dict(<span class="ansi-yellow-bg">roster_df</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">loc</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span><span style="color: rgb(98,98,98)">.</span>to_dict(), mapper<span style="color: rgb(98,98,98)">=</span>abbr2shiftproperties)

File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/indexing.py:895</span>, in <span class="ansi-cyan-fg">_LocationIndexer.__getitem__</span><span class="ansi-blue-fg">(self, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    892</span> axis <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>axis <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(98,98,98)">0</span>
<span class="ansi-green-intense-fg ansi-bold">    894</span> maybe_callable <span style="color: rgb(98,98,98)">=</span> com<span style="color: rgb(98,98,98)">.</span>apply_if_callable(key, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>obj)
<span class="ansi-green-fg">--&gt; 895</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_getitem_axis</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">maybe_callable</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/indexing.py:1124</span>, in <span class="ansi-cyan-fg">_LocIndexer._getitem_axis</span><span class="ansi-blue-fg">(self, key, axis)</span>
<span class="ansi-green-intense-fg ansi-bold">   1122</span> <span style="color: rgb(95,135,135)"># fall thru to straight lookup</span>
<span class="ansi-green-intense-fg ansi-bold">   1123</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_validate_key(key, axis)
<span class="ansi-green-fg">-&gt; 1124</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_get_label</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/indexing.py:1073</span>, in <span class="ansi-cyan-fg">_LocIndexer._get_label</span><span class="ansi-blue-fg">(self, label, axis)</span>
<span class="ansi-green-intense-fg ansi-bold">   1071</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">_get_label</span>(<span style="color: rgb(0,135,0)">self</span>, label, axis: <span style="color: rgb(0,135,0)">int</span>):
<span class="ansi-green-intense-fg ansi-bold">   1072</span>     <span style="color: rgb(95,135,135)"># GH#5667 this will fail if the label is not present in the axis.</span>
<span class="ansi-green-fg">-&gt; 1073</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">obj</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">xs</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">label</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/generic.py:3739</span>, in <span class="ansi-cyan-fg">NDFrame.xs</span><span class="ansi-blue-fg">(self, key, axis, level, drop_level)</span>
<span class="ansi-green-intense-fg ansi-bold">   3737</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">TypeError</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Expected label or tuple of labels, got </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">e</span>
<span class="ansi-green-intense-fg ansi-bold">   3738</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 3739</span>     loc <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">index</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">get_loc</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">key</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3741</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(loc, np<span style="color: rgb(98,98,98)">.</span>ndarray):
<span class="ansi-green-intense-fg ansi-bold">   3742</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> loc<span style="color: rgb(98,98,98)">.</span>dtype <span style="color: rgb(98,98,98)">==</span> np<span style="color: rgb(98,98,98)">.</span>bool_:

File <span class="ansi-green-fg">~/miniconda3/envs/py39/lib/python3.9/site-packages/pandas/core/indexes/base.py:3082</span>, in <span class="ansi-cyan-fg">Index.get_loc</span><span class="ansi-blue-fg">(self, key, method, tolerance)</span>
<span class="ansi-green-intense-fg ansi-bold">   3080</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_engine<span style="color: rgb(98,98,98)">.</span>get_loc(casted_key)
<span class="ansi-green-intense-fg ansi-bold">   3081</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> err:
<span class="ansi-green-fg">-&gt; 3082</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">KeyError</span>(key) <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">err</span>
<span class="ansi-green-intense-fg ansi-bold">   3084</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> tolerance <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">   3085</span>     tolerance <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_convert_tolerance(tolerance, np<span style="color: rgb(98,98,98)">.</span>asarray(key))

<span class="ansi-red-fg">KeyError</span>: &#39;&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">roster_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">roster_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">mapper</span><span class="o">=</span><span class="n">abbr2shiftproperties</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not create roster for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.ics&quot;</span>
    <span class="k">with</span> <span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;output&quot;</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">to_ics</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

